mysql> CREATE TABLE departments ( 
    -> dept_id INT PRIMARY KEY, 
    -> dept_name VARCHAR(30) 
    -> );
Query OK, 0 rows affected (0.02 sec)

mysql> CREATE TABLE employees ( 
    -> emp_id INT PRIMARY KEY, 
    -> emp_name VARCHAR(50), 
    -> dept_id INT, 
    -> salary DECIMAL(10,2), 
    -> experience INT, 
    -> join_date DATE, 
    -> FOREIGN KEY (dept_id) REFERENCES 
    -> departments(dept_id) 
    -> ); 
Query OK, 0 rows affected (0.04 sec)

mysql> INSERT INTO departments VALUES
    -> (1, 'HR'),
    -> (2, 'Finance'),
    -> (3, 'IT'),
    -> (4, 'Marketing');
Query OK, 4 rows affected (0.01 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> 
mysql> INSERT INTO employees VALUES
    -> (101, 'Arun',    3, 75000.00, 6, '2018-06-15'),
    -> (102, 'Meena',   2, 68000.00, 5, '2020-01-10'),
    -> (103, 'Asha',    1, 55000.00, 4, '2021-03-20'),
    -> (104, 'Ravi',    3, 90000.00, 8, '2017-11-05'),
    -> (105, 'Kiran',   4, 62000.00, 3, '2019-08-18'),
    -> (106, 'Anita',   2, 80000.00, 7, '2016-04-12'),
    -> (107, 'Suresh',  1, 50000.00, 2, '2022-09-01');
Query OK, 7 rows affected (0.01 sec)
Records: 7  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM departments;
+---------+-----------+
| dept_id | dept_name |
+---------+-----------+
|       1 | HR        |
|       2 | Finance   |
|       3 | IT        |
|       4 | Marketing |
+---------+-----------+
4 rows in set (0.00 sec)

mysql> SELECT * FROM employees;
+--------+----------+---------+----------+------------+------------+
| emp_id | emp_name | dept_id | salary   | experience | join_date  |
+--------+----------+---------+----------+------------+------------+
|    101 | Arun     |       3 | 75000.00 |          6 | 2018-06-15 |
|    102 | Meena    |       2 | 68000.00 |          5 | 2020-01-10 |
|    103 | Asha     |       1 | 55000.00 |          4 | 2021-03-20 |
|    104 | Ravi     |       3 | 90000.00 |          8 | 2017-11-05 |
|    105 | Kiran    |       4 | 62000.00 |          3 | 2019-08-18 |
|    106 | Anita    |       2 | 80000.00 |          7 | 2016-04-12 |
|    107 | Suresh   |       1 | 50000.00 |          2 | 2022-09-01 |
+--------+----------+---------+----------+------------+------------+
7 rows in set (0.00 sec)

mysql> 
mysql> 
mysql> SELECT e.*
    -> FROM employees e
    -> JOIN departments d ON e.dept_id = d.dept_id
    -> WHERE d.dept_name = 'IT';
+--------+----------+---------+----------+------------+------------+
| emp_id | emp_name | dept_id | salary   | experience | join_date  |
+--------+----------+---------+----------+------------+------------+
|    101 | Arun     |       3 | 75000.00 |          6 | 2018-06-15 |
|    104 | Ravi     |       3 | 90000.00 |          8 | 2017-11-05 |
+--------+----------+---------+----------+------------+------------+
2 rows in set (0.00 sec)

mysql> SELECT *
    -> FROM employees
    -> WHERE salary BETWEEN 60000 AND 80000;
+--------+----------+---------+----------+------------+------------+
| emp_id | emp_name | dept_id | salary   | experience | join_date  |
+--------+----------+---------+----------+------------+------------+
|    101 | Arun     |       3 | 75000.00 |          6 | 2018-06-15 |
|    102 | Meena    |       2 | 68000.00 |          5 | 2020-01-10 |
|    105 | Kiran    |       4 | 62000.00 |          3 | 2019-08-18 |
|    106 | Anita    |       2 | 80000.00 |          7 | 2016-04-12 |
+--------+----------+---------+----------+------------+------------+
4 rows in set (0.00 sec)

mysql> SELECT *
    -> FROM employees
    -> WHERE experience > 5;
+--------+----------+---------+----------+------------+------------+
| emp_id | emp_name | dept_id | salary   | experience | join_date  |
+--------+----------+---------+----------+------------+------------+
|    101 | Arun     |       3 | 75000.00 |          6 | 2018-06-15 |
|    104 | Ravi     |       3 | 90000.00 |          8 | 2017-11-05 |
|    106 | Anita    |       2 | 80000.00 |          7 | 2016-04-12 |
+--------+----------+---------+----------+------------+------------+
3 rows in set (0.00 sec)

mysql> SELECT *
    -> FROM employees
    -> WHERE emp_name LIKE 'A%';
+--------+----------+---------+----------+------------+------------+
| emp_id | emp_name | dept_id | salary   | experience | join_date  |
+--------+----------+---------+----------+------------+------------+
|    101 | Arun     |       3 | 75000.00 |          6 | 2018-06-15 |
|    103 | Asha     |       1 | 55000.00 |          4 | 2021-03-20 |
|    106 | Anita    |       2 | 80000.00 |          7 | 2016-04-12 |
+--------+----------+---------+----------+------------+------------+
3 rows in set (0.00 sec)

mysql> SELECT *
    -> FROM employees
    -> WHERE join_date > '2019-12-31';
+--------+----------+---------+----------+------------+------------+
| emp_id | emp_name | dept_id | salary   | experience | join_date  |
+--------+----------+---------+----------+------------+------------+
|    102 | Meena    |       2 | 68000.00 |          5 | 2020-01-10 |
|    103 | Asha     |       1 | 55000.00 |          4 | 2021-03-20 |
|    107 | Suresh   |       1 | 50000.00 |          2 | 2022-09-01 |
+--------+----------+---------+----------+------------+------------+
3 rows in set (0.00 sec)

mysql> 
mysql> SELECT e.*
    -> FROM employees e
    -> JOIN departments d ON e.dept_id = d.dept_id
    -> WHERE d.dept_name IN ('HR', 'Finance');
+--------+----------+---------+----------+------------+------------+
| emp_id | emp_name | dept_id | salary   | experience | join_date  |
+--------+----------+---------+----------+------------+------------+
|    103 | Asha     |       1 | 55000.00 |          4 | 2021-03-20 |
|    107 | Suresh   |       1 | 50000.00 |          2 | 2022-09-01 |
|    102 | Meena    |       2 | 68000.00 |          5 | 2020-01-10 |
|    106 | Anita    |       2 | 80000.00 |          7 | 2016-04-12 |
+--------+----------+---------+----------+------------+------------+
4 rows in set (0.00 sec)

mysql> SELECT *
    -> FROM employees
    -> WHERE salary NOT BETWEEN 55000 AND 70000;
+--------+----------+---------+----------+------------+------------+
| emp_id | emp_name | dept_id | salary   | experience | join_date  |
+--------+----------+---------+----------+------------+------------+
|    101 | Arun     |       3 | 75000.00 |          6 | 2018-06-15 |
|    104 | Ravi     |       3 | 90000.00 |          8 | 2017-11-05 |
|    106 | Anita    |       2 | 80000.00 |          7 | 2016-04-12 |
|    107 | Suresh   |       1 | 50000.00 |          2 | 2022-09-01 |
+--------+----------+---------+----------+------------+------------+
4 rows in set (0.00 sec)

mysql> SELECT *
    -> FROM employees
    -> ORDER BY salary DESC
    -> LIMIT 3;
+--------+----------+---------+----------+------------+------------+
| emp_id | emp_name | dept_id | salary   | experience | join_date  |
+--------+----------+---------+----------+------------+------------+
|    104 | Ravi     |       3 | 90000.00 |          8 | 2017-11-05 |
|    106 | Anita    |       2 | 80000.00 |          7 | 2016-04-12 |
|    101 | Arun     |       3 | 75000.00 |          6 | 2018-06-15 |
+--------+----------+---------+----------+------------+------------+
3 rows in set (0.00 sec)

mysql> SELECT *
    -> FROM employees
    -> ORDER BY experience DESC;
+--------+----------+---------+----------+------------+------------+
| emp_id | emp_name | dept_id | salary   | experience | join_date  |
+--------+----------+---------+----------+------------+------------+
|    104 | Ravi     |       3 | 90000.00 |          8 | 2017-11-05 |
|    106 | Anita    |       2 | 80000.00 |          7 | 2016-04-12 |
|    101 | Arun     |       3 | 75000.00 |          6 | 2018-06-15 |
|    102 | Meena    |       2 | 68000.00 |          5 | 2020-01-10 |
|    103 | Asha     |       1 | 55000.00 |          4 | 2021-03-20 |
|    105 | Kiran    |       4 | 62000.00 |          3 | 2019-08-18 |
|    107 | Suresh   |       1 | 50000.00 |          2 | 2022-09-01 |
+--------+----------+---------+----------+------------+------------+
7 rows in set (0.00 sec)

mysql> SELECT *
    -> FROM employees
    -> LIMIT 4 OFFSET 1;
+--------+----------+---------+----------+------------+------------+
| emp_id | emp_name | dept_id | salary   | experience | join_date  |
+--------+----------+---------+----------+------------+------------+
|    102 | Meena    |       2 | 68000.00 |          5 | 2020-01-10 |
|    103 | Asha     |       1 | 55000.00 |          4 | 2021-03-20 |
|    104 | Ravi     |       3 | 90000.00 |          8 | 2017-11-05 |
|    105 | Kiran    |       4 | 62000.00 |          3 | 2019-08-18 |
+--------+----------+---------+----------+------------+------------+
4 rows in set (0.00 sec)

mysql> \T
Currently logging to file 'sqloutput.txt'
mysql> \T
Currently logging to file 'sqloutput.txt'
mysql> exit
mysql> SELECT COUNT(*) AS total_employees FROM employees;
+-----------------+
| total_employees |
+-----------------+
|               7 |
+-----------------+
1 row in set (0.01 sec)

mysql> SELECT AVG(salary) AS average_salary FROM employees;
+----------------+
| average_salary |
+----------------+
|   68571.428571 |
+----------------+
1 row in set (0.00 sec)

mysql> SELECT MAX(salary) AS highest_salary FROM employees;
+----------------+
| highest_salary |
+----------------+
|       90000.00 |
+----------------+
1 row in set (0.00 sec)

mysql> SELECT MIN(e.salary) AS lowest_salary FROM employees e JOIN departments d ON e.dept_id=d.dept_id WHERE d.dept_name='Marketing';
+---------------+
| lowest_salary |
+---------------+
|      62000.00 |
+---------------+
1 row in set (0.00 sec)

mysql> SELECT SUM(e.salary) AS total_it_salary FROM employees e JOIN departments d ON e.dept_id=d.dept_id WHERE d.dept_name='IT';
+-----------------+
| total_it_salary |
+-----------------+
|       165000.00 |
+-----------------+
1 row in set (0.00 sec)

mysql> SELECT d.dept_name, COUNT(e.emp_id) AS employee_count FROM employees e JOIN departments d ON e.dept_id=d.dept_id GROUP BY d.dept_name;
+-----------+----------------+
| dept_name | employee_count |
+-----------+----------------+
| HR        |              2 |
| Finance   |              2 |
| IT        |              2 |
| Marketing |              1 |
+-----------+----------------+
4 rows in set (0.00 sec)

mysql> SELECT d.dept_name, AVG(e.salary) AS avg_salary FROM employees e JOIN departments d ON e.dept_id=d.dept_id GROUP BY d.dept_name;
+-----------+--------------+
| dept_name | avg_salary   |
+-----------+--------------+
| HR        | 52500.000000 |
| Finance   | 74000.000000 |
| IT        | 82500.000000 |
| Marketing | 62000.000000 |
+-----------+--------------+
4 rows in set (0.00 sec)

mysql> SELECT d.dept_name, MAX(e.experience) AS max_experience FROM employees e JOIN departments d ON e.dept_id=d.dept_id GROUP BY d.dept_name;
+-----------+----------------+
| dept_name | max_experience |
+-----------+----------------+
| HR        |              4 |
| Finance   |              7 |
| IT        |              8 |
| Marketing |              3 |
+-----------+----------------+
4 rows in set (0.00 sec)

mysql> SELECT d.dept_name, SUM(e.salary) AS total_salary FROM employees e JOIN departments d ON e.dept_id=d.dept_id GROUP BY d.dept_name;
+-----------+--------------+
| dept_name | total_salary |
+-----------+--------------+
| HR        |    105000.00 |
| Finance   |    148000.00 |
| IT        |    165000.00 |
| Marketing |     62000.00 |
+-----------+--------------+
4 rows in set (0.00 sec)

mysql> SELECT d.dept_name, AVG(e.salary) AS avg_salary FROM employees e JOIN departments d ON e.dept_id=d.dept_id GROUP BY d.dept_name ORDER BY avg_salary DESC;
+-----------+--------------+
| dept_name | avg_salary   |
+-----------+--------------+
| IT        | 82500.000000 |
| Finance   | 74000.000000 |
| Marketing | 62000.000000 |
| HR        | 52500.000000 |
+-----------+--------------+
4 rows in set (0.00 sec)

mysql> SELECT d.dept_name, COUNT(e.emp_id) AS employee_count FROM employees e JOIN departments d ON e.dept_id=d.dept_id GROUP BY d.dept_name HAVING COUNT(e.emp_id) > 1;
+-----------+----------------+
| dept_name | employee_count |
+-----------+----------------+
| HR        |              2 |
| Finance   |              2 |
| IT        |              2 |
+-----------+----------------+
3 rows in set (0.00 sec)

mysql> SELECT d.dept_name, AVG(e.salary) AS avg_salary FROM employees e JOIN departments d ON e.dept_id=d.dept_id GROUP BY d.dept_name HAVING AVG(e.salary) > 70000;
+-----------+--------------+
| dept_name | avg_salary   |
+-----------+--------------+
| Finance   | 74000.000000 |
| IT        | 82500.000000 |
+-----------+--------------+
2 rows in set (0.01 sec)

mysql> SELECT d.dept_name, SUM(e.salary) AS total_salary FROM employees e JOIN departments d ON e.dept_id=d.dept_id GROUP BY d.dept_name HAVING SUM(e.salary) > 150000;
+-----------+--------------+
| dept_name | total_salary |
+-----------+--------------+
| IT        |    165000.00 |
+-----------+--------------+
1 row in set (0.00 sec)

mysql> SELECT d.dept_name, MAX(e.experience) AS max_experience FROM employees e JOIN departments d ON e.dept_id=d.dept_id GROUP BY d.dept_name HAVING MAX(e.experience) > 7;
+-----------+----------------+
| dept_name | max_experience |
+-----------+----------------+
| IT        |              8 |
+-----------+----------------+
1 row in set (0.00 sec)

mysql> SELECT d.dept_name, MIN(e.salary) AS min_salary FROM employees e JOIN departments d ON e.dept_id=d.dept_id GROUP BY d.dept_name HAVING MIN(e.salary) > 60000;
+-----------+------------+
| dept_name | min_salary |
+-----------+------------+
| Finance   |   68000.00 |
| IT        |   75000.00 |
| Marketing |   62000.00 |
+-----------+------------+
3 rows in set (0.00 sec)

mysql> \T
Currently logging to file 'sqloutput.txt'
mysql> exit
